var wahlpflichtbild="<img src='images/Wahlpflicht.png'>",pflichtbild="<img src='images/Pflicht.png'>",wahlbild="<img src='images/Wahl.png'>",unbekannter_modus_bild="<img src='images/ModusUnbekannt.png'>",fragebild="<img src='images/Fragezeichen.png'>",gruener_ipunkt="<img src='images/iPunkt.png'>",gelber_ipunkt="<img src='images/iPunktGelb.png'>",roter_ipunkt="<img src='images/Ausrufezeichen.png'>",loeschenbild="<img src='images/Loeschen.png' style='position:relative; top:-4px; left:8px;'>",pfeil_rechts=
"<img src='images/Pfeil-Rechts.png' style='padding-right:3px;'>",pfeil_unten="<img src='images/Pfeil-Unten.png' style='padding-right:3px;'>",pfeil_leer="<img src='images/Pfeil-Rechts-Leer.png' style='padding-right:3px;'>",warten_weiss="<img src='images/Warten-HintergrundWeiss.gif' style='padding-right:3px;'>",warten_blau="<img src='images/Warten-HintergrundGrau.gif' style='padding-right:3px;'>",warten_semester_animation="<img src='images/Warten-HintergrundSemester.gif' style='padding-right:3px;'>";
$(document).ready(function(){$("#pleasewait").slideUp("slow");$(".ipunkt_td, .fragebild").mouseenter(function(){$(this).animate({opacity:0.4},"fast");$(this).animate({opacity:1},"fast")});$("#GetStartedImage").animate({opacity:0.1},"slow");$("#GetStartedImage").animate({opacity:1},"fast");$("#GetStartedImage").animate({opacity:0.1},"slow");$("#GetStartedImage").animate({opacity:1},"fast");$("#GetStartedImage").animate({opacity:0.1},"slow");$("#GetStartedImage").animate({opacity:1},"fast");$("#GetStartedImage").animate({opacity:0.1},
"slow");$("#GetStartedImage").animate({opacity:1},"fast");$("#GetStartedImage").animate({opacity:0.1},"slow");$("#GetStartedImage").animate({opacity:1},"fast")});
var authenticityToken=function(){return $("#token").attr("content")},authenticityTokenParameter=function(){return"authenticity_token="+encodeURIComponent(authenticityToken())},change_credit_and_add_name_in_selection=function(a,b){var c=modProp(a,"credits_in_selection");$(b).find(".modul_credit").text(c+" C");a=modProp(a,"add_sel_name_in_sel");$(b).find(".modul_name").append(a);return 0},change_credit_and_remove_name_in_pool=function(a,b){var c=modProp(a,"credits");$(b).find(".modul_credit").text(c+
" C");a=modProp(a,"modul_name_in_pool");$(b).find(".modul_name").text(a);return 0},flip_module_infoicon_on_event=function(a,b,c){var d=$(c).attr("class");$(c).hasClass("auswahl_modul_clone")||$(c).hasClass("auswahl_modul")||$(c).hasClass("custom_modul")||$(c).hasClass("pool_modul")||alert("Fehler: Handle in flip_module_infoicon_on_event("+a+") ist kein Modul (class="+d+")!");switch(a){case "error":if(modProp(b,"error")!="true"){if(modProp(b,"AO_disable_warning")!="true"){a=$(c).find(".ipunkt");$(a).html(roter_ipunkt);
if(modProp(b,"error")!="unknown"){$(a).animate({opacity:0.1},"fast");$(a).animate({opacity:1},"fast");$(a).animate({opacity:0.1},"fast");$(a).animate({opacity:1},"fast");$(a).animate({opacity:0.1},"fast");$(a).animate({opacity:1},"fast")}}modPropChange(b,"error","true")}break;case "no_error":if(modProp(b,"error")!="false"){a=$(c).find(".ipunkt");modProp(b,"modul_has_grade")=="true"&&$(c).find(".noten_input").val()=="Note"?a.html(gelber_ipunkt):a.html(gruener_ipunkt);if(modProp(b,"error")!="unknown"){$(a).animate({opacity:0.1},
"fast");$(a).animate({opacity:1},"fast");$(a).animate({opacity:0.1},"fast");$(a).animate({opacity:1},"fast");$(a).animate({opacity:0.1},"fast");$(a).animate({opacity:1},"fast")}modPropChange(b,"error","false")}break;case "entered_grade":modProp(b,"error")=="false"&&$(c).find(".ipunkt").html(gruener_ipunkt);break;case "invalid_grade":modProp(b,"error")=="false"&&$(c).find(".ipunkt").html(gelber_ipunkt);break;case "init":modProp(b,"modul_has_grade")=="true"&&($(c).find(".noten_input").val()!="Note"||
$(c).find(".noten_input").val()!="")?$(c).find(".ipunkt").html(gelber_ipunkt):$(c).find(".ipunkt").html(gruener_ipunkt);break;default:alert("Fehler in flip_module_infoicon_on_event: Event-Typ "+a+" unbekannt!")}},selection_input_check=function(a){var b,c=$(a).val(),d=$(a).attr("rel"),g=$.trim(c),e=c.search(/./),k=$(a).parent().parent().parent().parent().parent().parent();if(e!=-1)b=c.replace(/\./,",");e=parseFloat(g);if(c==""||isNaN(e)){alert("Bitte geben Sie eine Zahl zwischen 1,0 und 4,0 ein.");
$(a).attr("value","Note");ajax_serverupdate_grade_reset(d);flip_module_infoicon_on_event("invalid_grade",d,k)}else{c=g.replace(/,/,".");c=parseFloat(c);if(c==0){ajax_serverupdate_grade_reset(d);$(a).attr("value","Note");flip_module_infoicon_on_event("invalid_grade",d,k);ajax_request_grade()}else if(c<1||c>4){alert("Bitte geben Sie eine Zahl zwischen 1,0 und 4,0 ein.");flip_module_infoicon_on_event("invalid_grade",d,k);$(a).attr("value","Note");ajax_serverupdate_grade_reset(d);$("#note_berechnen").text("")}else{$(a).attr("value",
b);flip_module_infoicon_on_event("entered_grade",d,k);ajax_serverupdate_grade(d,c)}}$("#note_berechnen").text("");ajax_request_grade()};function rekursiv_pool_by_out(a,b){var c=$(a).attr("class");c=="pool_category"||c=="search_category"||alert("Fehler: Handle in rekursiv_pool_by_out() ist keine Kategorie!");c=$(a).parent();if(number_of_visible_items_in_category(a)==b){$(a).attr("class","pool_category");$(a).css("display","none");$(c).attr("id")!="pool"&&rekursiv_pool_by_out(c,0)}}
function rekursiv_pool_by_in(a){$(a).show();flip_arrow_of_category("unten",a);$(a).is(".pool_category")&&$(a).attr("class","search_category");a=$(a).parent().get(0);$(a).is(".pool_category")&&rekursiv_pool_by_in(a)}function font_size(a){$("body,table").css("font-size",a+"px")}
var show_navi=function(){$("#navi_optional").slideDown();$("#navimovedown").toggle();$("#navimoveup").show();$("#ueberblick").css("width","100%");$("#ueberblick").css("position","relative");$("#middle").css("margin-left","1%")},hide_navi=function(){$("#navi_optional").slideUp();$("#navimovedown").show();$("#navimoveup").hide();$("#ueberblick").css("width","22%");$("#ueberblick").css("position","fixed");$("#middle").css("margin-left","24%");$("#help_optional").hide();$("#helpmovedown").show()},show_minihelp=
function(){$("#help_optional").slideDown();$("#helpmovedown").hide()},hide_partial_modul=function(){$("#pool .partial_modul").hide()},custom_modul_rekursiv=function(a){$(a).children().not("a,.nichtleer").each(function(){var b=$(this).attr("class"),c=$(this).attr("rel");if(b=="pool_category")custom_modul_rekursiv(this);else if(c=="mod_parent"){b=$(this).children().not(".nichtleer").eq(0);if($(b).hasClass("custom_modul")&&$(b).css("display")=="block"){$(b).hide();$(b).attr("class","pool_modul");$(this).siblings().each(function(){var d=
$(this).children().not(".nichtleer").eq(0);$(d).hasClass("custom_modul")&&$(d).hide()})}}})},show_next_custom_modul_in_pool=function(a){a=$("#pool").find("#"+a);a=$(a).find(".custom_modul").filter(function(c){return c==0});if(search_is_active){var b=$(a).parent().get(0);$(b).addClass("search_modul")}$(a).removeClass("custom_modul").addClass("pool_modul ui-draggable");$(a).show()},get_and_change_custom_modul_in_the_table=function(a,b,c){a=$("#suche").find("."+a);$(a).find(">.td_custom_name").text(b);
b=$("#suche").find("tr[rel='custom_modul']").filter(function(){if($(this).find(">.cat_check").text()==c)return this}).eq(0);$(b).attr("rel","pool_modul").show()},custom_modul_in_the_search_table_rekursiv=function(){$("#suche").find("tr[rel='custom_modul']").each(function(){var a=$(this).find(">td.cat_check"),b=$(a).text();if($(a).attr("rel")=="noCheck"){$(this).attr("rel","pool_modul");$(this).show();$(this).siblings().each(function(){var c=$(this).find(">td.cat_check");$(c).text()==b&&$(c).attr("rel",
"checked")})}})},partial_modul_loeschen=function(a,b){$("#middle div.subsemester").find("div").each(function(){var c=$(this).attr("id");c!=""&&modProp(c,"id_of_parent_modul")==a&&sub_modul_loeschen(this,c,b)});ueberblick()},modul_loeschen=function(a,b){$("#middle div.semester").find("div#"+a).each(function(){var c=modProp(a,"modul_parts"),d=modProp(a,"id_of_parent_modul");if(c!="0"||d!="false"){if(confirm("Dieses Modul besteht aus mehreren Teilmodulen - wenn Sie es entfernen, werden alle weiteren Teile ebenfalls entfernt.")==
true)if(d!="false"){c=$("#middle div.semester").find("div#"+d);change_credit_and_remove_name_in_pool(d,c);sub_modul_loeschen(c,d,b);partial_modul_loeschen(d,b);modPropChange(d,"head_modul_in_pool","true")}else{modPropChange(a,"head_modul_in_pool","true");change_credit_and_remove_name_in_pool(a,this);sub_modul_loeschen(this,a,b);partial_modul_loeschen(a,b)}}else sub_modul_loeschen(this,a,b)})},sub_modul_loeschen=function(a,b,c){change_module_style_to_pool(b,a);var d=modProp(b,"modul_parts"),g=modProp(b,
"id_of_parent_modul"),e="pool_modul";if($(a).attr("class")=="auswahl_modul partial_modul")e="partial_modul";$(a).attr("class",e);modProp(b,"modul_parts_exist")=="true"&&modPropChange(b,"modul_parts_exist","false");var k=$(a).attr("id"),l=$(a),i=true;$(l).hide();modPropChange(b,"error","unknown");$("#pool ."+k+"_parent").each(function(){var h=which_arrow_is_visible($(this).parent()),o=$(this).parent();if(module_div_present_in_parent($(this)))if(h=="leer")flip_arrow_of_category("rechts",$(this).parent());
else{if(h=="unten")if(!search_is_active()||$(this).is(".search_modul"))modProp(b,"custom")!="custom"&&$(this).find("#"+b).css("display","block")}else{$(this).append(l);i=false;if(h=="leer")flip_arrow_of_category("rechts",$(this).parent());else if(h=="unten")search_is_active()||e!="partial_modul"&&modProp(b,"custom")!="custom"&&$(this).find("#"+b).css("display","block")}modPropChange(b,"inAuswahl","false");if(search_is_active()&&$(this).is(".search_modul")&&(which_arrow_is_visible($(this).parent())!=
"rechts"||$(o).is(".pool_category"))){h=$(this).find("#"+b).eq(0);if($(h).attr("class")!="partial_modul"||$(h).attr("class")!="partial_modul ui-draggable")modProp(b,"custom")!="custom"?$(h).show():alert("ich bin da das Dummy in search-active");rekursiv_pool_by_in(o)}else which_arrow_is_visible(o)=="leer"&&flip_arrow_of_category("rechts",o)});i&&$(l).remove();ajax_serverupdate_remove(b);d=="0"&&g=="false"&&c!="10000"&&ueberblick()},info_box_selection=function(a){$("#exception_credit").attr("rel",a);
$("#box_info").empty();$("#box_info_exception").show();$("#box_info_pool").hide();$("#box_info_combobox").hide();$("#box_info_overview").hide();ajax_request_module_info(a);$("#info_box").dialog("open")},info_box=function(a){$("#box_info").empty();$("#box_info_exception").hide();$("#box_info_combobox").hide();$("#box_info_overview").hide();$("#box_info_pool").show();ajax_request_pool_module_info(a);$("#info_box").dialog("open")},update_modul_in_selection=function(){var a=false;$("#credit_exception_change").val();
var b=$("#exception_credit").attr("rel"),c=$("#semester-content .subsemester").find("div#"+b).eq(0);if($(c).text()=="")a=true;if(a)c=$("#semesterBOX .subsemester").find("div#"+b).eq(0);a=false;var d=$("#exception_warn:checked").val()=="checkbox",g=$("#exception_note:checked").val()=="checkbox";if(modProp(b,"AO_ignore_grade")=="true"!=g){a=true;if(g){modPropChange(b,"AO_ignore_grade","true");$(c).find("p.note-option").show();ajax_serverupdate_remove_grade(b)}else{modPropChange(b,"AO_ignore_grade",
"false");$(c).find("p.note-option").hide();ajax_serverupdate_add_grade(b)}}if(modProp(b,"AO_disable_warning")=="true"!=d){a=true;if(d){modPropChange(b,"AO_disable_warning","true");$(c).find("p.warnung-option").show();ajax_serverupdate_remove_warning(b)}else{modPropChange(b,"AO_disable_warning","false");$(c).find("p.warnung-option").hide();ajax_serverupdate_add_warning(b)}}d=$("#exception_credit").val();g=d!=""&&!isNaN(d)&&parseInt(d)>=0;var e=d=="Credits"||d==""||g;if(modProp(b,"custom")=="non-custom"&&
e)if(modProp(b,"AO_custom_credits")!="false"!=g||modProp(b,"AO_custom_credits")!="false"&&modProp(b,"AO_custom_credits")!=d){a=true;if(g){modPropChange(b,"AO_custom_credits",d);$(c).find(".modul_credit").text(d+" C");$(c).find("p.credit-option").show();ajax_serverupdate_change_credits(b,d)}else{modPropChange(b,"AO_custom_credits","false");$(c).find(".modul_credit").text(modProp(b,"credits")+" C");$(c).find("p.credit-option").hide();ajax_serverupdate_credits_reset(b)}}a&&ueberblick()},change_custom_in_selection_by_session_load=
function(a,b,c){$(a).find(".modul_name").text(b);$(a).find(".modul_credit").text(c+" C");$(a).attr("class","pool_modul ui-draggable");modPropChange($(a).attr("id"),"custom_exist","true");return 0},session_auswahl_rekursiv=function(a){var b=$("#semester-content");$(a).children().each(function(){var c=this.nodeName;if(c=="module"){c=$(this).parent().get(0);var d=$(c).attr("count"),g=$(this).attr("id"),e=$(this).attr("grade"),k=$(this).attr("has_grade"),l=$(this).attr("custom_credits"),i=$(this).attr("has_warning"),
h=$("#pool").find("div#"+g),o=$(h).eq(0);c=modProp(g,"additional_info");var m=$(o).clone(true);$(h).each(function(){$(this).hide();modPropChange(g,"inAuswahl","true")});if(modProp(g,"custom")=="custom"){h=$(this).attr("name");o=$(this).attr("credits");modPropChange(g,"modul_has_grade",$(this).attr("has_general_grade"));change_custom_in_selection_by_session_load(m,h,o)}if(k=="false"){$(m).find("p.note-option").show();modPropChange(g,"AO_ignore_grade","true")}$(m).attr("class","auswahl_modul_clone");
change_module_style_to_auswahl(g,m);if(l!="false"){if(modProp(g,"custom")!="custom"){$(m).find("p.credit-option").show();modPropChange(g,"AO_custom_credits",l)}$(m).find("td.modul_credit").text(l+" C")}if(i=="false"){$(m).find("p.warnung-option").show();modPropChange(g,"AO_disable_warning","true")}if(e!=""&&parseFloat(e)>0.5){k=$(m).find(".noten_input");l=e;if(e.search(/./)!=-1)l=e.replace(/\./,",");$(k).val(l);flip_module_infoicon_on_event("entered_grade",g,m)}modPropChange(g,"inAuswahl","true");
if(modProp(g,"modul_parts")!="0"){modPropChange(g,"head_modul_in_pool","false");change_credit_and_add_name_in_selection(g,m);modPropChange(g,"modul_parts_exist","true")}modProp(g,"id_of_parent_modul")!="false"&&$(m).show();if(d=="0"){e=$("#middle").find("#semesterBOX .subsemester");$(e).append(m)}$(b).find("div.semester").each(function(){var q=$(this).attr("id");d==q&&$(this).find(".subsemester").append(m)});if(c=="true"){ajax_request_combobox(g);modPropChange(g,"additional_info","drop_down_schon_in_auswahl")}}else{if(c==
"semester"){c=$(this).attr("count");c!="0"&&$(b).append("<div class='semester' id='"+c+"'><div class='subsemester'><h5>"+c+". Semester</h5></div><a style='display:none;' class='semesterloeschen' onClick='sem_loeschen("+c+");'>Semester entfernen</a></div>")}session_auswahl_rekursiv(this)}})},session_auswahl=function(){var a=$.ajax({type:"GET",url:"abfragen/auswahl",async:false,contentType:"application/x-www-form-urlencoded",error:function(){alert("AJAX-Fehler: auswahl")}}).responseXML.documentElement;
$("semester-content").empty();$("#middle").find("#semesterBOX .subsemester").empty();session_auswahl_rekursiv(a);a=$("#semester-content div.semester:last");$(a).find("a.semesterloeschen").css("display","inline")},ajax_request_module_info=function(a){$.ajax({type:"POST",url:"/abfragen/get_module_info",async:false,dataType:"text",contentType:"application/x-www-form-urlencoded",data:"module_id="+a+"&"+authenticityTokenParameter(),success:function(b){$("#exception_credit").attr("value","Credits");$("#exception_warn").attr("checked",
"");$("#exception_note").attr("checked","");$("#info_box #box_info").append(b);if(modProp(a,"AO_ignore_grade")=="true"){modProp(a,"modul_has_grade")!="true"&&alert('ajax_request_module_info: Warnung: Unbenotetes Modul hat "Note streichen"-Option gesetzt');$("#exception_note").attr("checked","checked")}modProp(a,"AO_disable_warning")=="true"&&$("#exception_warn").attr("checked","checked");modProp(a,"AO_custom_credits")!="false"&&$("#exception_credit").attr("value",modProp(a,"AO_custom_credits"));modProp(a,
"modul_has_grade")!="true"?$("#note_streichen_checkbox").hide():$("#note_streichen_checkbox").show();modProp(a,"custom")=="custom"?$("#credits_aendern_checkbox").hide():$("#credits_aendern_checkbox").show()}})},ajax_request_pool_module_info=function(a){$.ajax({type:"POST",url:"/abfragen/get_pool_module_info",async:false,dataType:"text",contentType:"application/x-www-form-urlencoded",data:"module_id="+a+"&"+authenticityTokenParameter(),success:function(b){$("#info_box #box_info").append(b)}})},ajax_serverupdate_add=
function(a,b,c){$.ajax({type:"POST",url:"abfragen/add_module_to_selection",cache:false,dataType:"text",async:false,data:"mod_id="+a+"&sem_count="+b+"&cat_id="+c+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_remove=function(a){$.ajax({type:"POST",url:"abfragen/remove_module_from_selection",cache:false,dataType:"text",async:false,data:"mod_id="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_remove_semester=
function(a){$.ajax({type:"POST",url:"abfragen/remove_semester_from_selection",dataType:"text",cache:false,async:false,data:"sem_count="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"});ueberblick()},ajax_serverupdate_add_grade=function(a){$.ajax({type:"POST",url:"abfragen/add_grade",dataType:"text",cache:false,async:false,data:"mod_id="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_remove_grade=function(a){$.ajax({type:"POST",
url:"abfragen/remove_grade",dataType:"text",cache:false,async:false,data:"mod_id="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_add_warning=function(a){$.ajax({type:"POST",url:"abfragen/add_warning",dataType:"text",cache:false,async:false,data:"mod_id="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_remove_warning=function(a){$.ajax({type:"POST",url:"abfragen/remove_warning",dataType:"text",
cache:false,async:false,data:"mod_id="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_set_category=function(a,b){b!=undefined&&$.ajax({type:"POST",url:"main/set_category",dataType:"text",cache:false,async:false,data:"mod_id="+a+"&cat_id="+b+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_grade=function(a,b){$.ajax({type:"POST",url:"abfragen/save_module_grade",dataType:"text",cache:false,
async:false,data:"mod_id="+a+"&grade="+b+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded"})},ajax_serverupdate_grade_reset=function(a){ajax_serverupdate_grade(a,"")};
function ajax_request_combobox(a){$("#box_info_combobox").empty();$("#box_info,#box_info_pool,#box_info_exception,#box_info_overview").hide();$.ajax({type:"POST",url:"main/combo_category",dataType:"text",cache:false,async:false,data:"mod_id="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded",success:function(b){$("#semester-content").find(".semester").each(function(){$(this).find(">.subsemester").children().not("h5").each(function(){var c=$(this).attr("id");if(c==
a){var d=$(this).find("> p.drop_down_menu");d.show().append(b);d=d.find("select");d.change(function(){ajax_serverupdate_set_category(c,d.val());ueberblick()})}})})},error:function(){alert("AJAX-Fehler: custom_checkbox")}})}var ajax_request_grade=function(){$.ajax({type:"GET",url:"/abfragen/note",async:false,contentType:"application/x-www-form-urlencoded",success:function(a){$("#die_note").empty();$("#die_note").append(a)},error:function(){alert("AJAX-Fehler: note")}})};
function ajax_serverupdate_add_custom(a,b,c,d,g,e){c.shift();$.ajax({type:"POST",url:"abfragen/add_custom_module_to_selection",dataType:"text",cache:false,async:false,data:"name="+a+"&credits="+b+"&sem_count="+d+"&mod_id="+g+"&cat_id="+c.join(",")+"&has_grade="+e+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded",success:function(){ueberblick()}})}
function ajax_request_custom_checkbox(a){$("#dummy_checkbox").empty();$.ajax({type:"POST",url:"main/_check_category",dataType:"text",cache:false,async:false,data:"mod_id="+a+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded",success:function(b){$("#dummy_checkbox").append(b)},error:function(){alert("AJAX-Fehler: ajax_request_custom_checkbox")}})}
function ajax_serverupdate_change_credits(a,b){$.ajax({type:"POST",url:"abfragen/change_credits",dataType:"text",cache:false,async:false,data:"mod_id="+a+"&credits="+b+"&"+authenticityTokenParameter(),contentType:"application/x-www-form-urlencoded",error:function(){alert("AJAX-Fehler: change_credits")}})}function ajax_serverupdate_credits_reset(a){ajax_serverupdate_change_credits(a,"false")}
function update_module_errors(){var a=$.ajax({type:"GET",url:"/abfragen/errors",async:false,contentType:"application/x-www-form-urlencoded",success:function(){},error:function(){alert("AJAX-Fehler: /errors")}}).responseXML;$("#middle #error_table").empty();var b="";$(a.documentElement).children().each(function(){var c=$(this).attr("id");b+="<div id='error_"+c+"'>"+c+"</div>"});$("#middle #error_table").append(b);$("#semester-content").find(".semester").each(function(){$(this).find(">.subsemester").children().not("h5").each(function(){var c=
$(this).attr("id");check_error_on_init("error_"+c)?flip_module_infoicon_on_event("error",c,this):flip_module_infoicon_on_event("no_error",c,this)})})}
var check_error_on_init=function(a){var b=false;$("#middle #error_table").children().each(function(){if($(this).attr("id")==a)b=true});return b},drop_in_auswahl=function(a,b,c,d,g){$('<div class="quick-alert">'+warten_semester_animation+"Bitte warten!</div>").appendTo($(g)).fadeIn("fast").animate({opacity:1},1E3).fadeOut("fast",function(){$(this).remove()});var e=$(d).attr("class");b=modProp(a,"head_modul_in_pool");var k=modProp(a,"cat_id");if(e=="pool_modul ui-draggable"||e=="pool_modul"){change_module_style_to_auswahl(a,
d);modPropChange(a,"inAuswahl","true");$(d).attr("class","auswahl_modul_moving");e=$(d).parent().parent();if($(d).parent().is(".search_modul"))rekursiv_pool_by_out(e,1);else number_of_visible_items_in_category(e)==0&&flip_arrow_of_category("leer",e);$("."+a+"_parent").not(".auswahl_modul_moving").each(function(){$(this).attr("id");$(this).find(".pool_modul,.search_modul").css("display","none");var l=$(this).parent();if($(this).is(".search_modul"))rekursiv_pool_by_out(l,0);else number_of_visible_items_in_category(l)==
0&&flip_arrow_of_category("leer",l)});$(d).attr("class","auswahl_modul")}else ajax_serverupdate_remove(a);g=$(g).find("div.subsemester");$(g).append(d);ajax_serverupdate_add(a,c,k);if(b=="false")ueberblick();else{modPropChange(a,"head_modul_in_pool","false");ajax_request_grade()}if(modProp(a,"additional_info")=="true"){ajax_request_combobox(a);modPropChange(a,"additional_info","drop_down_schon_in_auswahl")}},custom_modul_drop_in_auswahl=function(a,b,c){b=modProp(a,"cat_id");$("#custom_semester").attr("value",
c);$("#custom_id").attr("value",a);$("#custom_cat_id").attr("value",b);$("#custom_dialog").dialog("open")},partial_modul_drop_in_auswahl=function(a,b,c,d,g){modPropChange(a,"modul_parts_exist","true");var e=$(g).find("div.subsemester");$(d).parent().get(0);b=$("#pool").find("."+a+"_parent").eq(0);$(b).nextAll().each(function(){this_id=$(this).children().eq(1).attr("id");if(this_id!=""&&modProp(this_id,"id_of_parent_modul")==a){var k=$(this).children().eq(1);$(k).attr("class","auswahl_modul partial_modul");
$(k).show();change_module_style_to_auswahl(this_id,k);$(e).append(k);ajax_serverupdate_add(this_id,c)}});ueberblick()},poolrekursiv=function(a){var b="";$(a).children().each(function(){var c=$(this).parent().get(0),d=c.nodeName;switch(this.nodeName){case "category":var g=$(this).attr("category_id"),e=$(this).attr("name");b+=d=="root"?"<div class='pool_category' id='"+g+"' rel=''>":"<div style='margin-left:6px;display:none;' class='pool_category' id='"+g+"' rel=''>";b+="<a style='cursor:pointer' alt='Kategorie auf- und zuklappen' onClick='javascript:toggle_category(\""+
g+"\");'><span class='pfeil_rechts' style='display:inline'>"+pfeil_rechts+"</span><span class='pfeil_unten' style='display:none'>"+pfeil_unten+"</span><span class='pfeil_leer' style='display:none'>"+pfeil_leer+"</span>"+e+"</a>";b+=poolrekursiv(this);b+="</div>";break;case "module":e=$(this).attr("id");d=$(c).attr("name");c=$(c).attr("category_id");var k=$(this).find("name").text(),l=$(this).find("mode").text(),i=$(this).find("credits").text(),h=$(this).find("parts").text(),o=$(this).attr("class"),
m=$(this).attr("additional_server_info"),q="true";if($(this).attr("has_grade")=="false")q="false";var p;switch(l){case "p":p=pflichtbild;break;case "wp":p=wahlpflichtbild;break;case "w":p=wahlbild;break;default:p=unbekannter_modus_bild}var w=$(this).find("add_sel_name").text(),u="pool_modul",s="false",C="",D="false";if(h!="0")D="true";if($(this).attr("parent")!=""){u="partial_modul";s=$(this).attr("parent");C=w}var x="false";if(o=="custom"){u="custom_modul";x=c}var z="0",A=$(this).attr("total_credits"),
F=i;if(A!="")i=z=A;modPropForce(e,"name",k);modPropForce(e,"modul_has_grade",q);modPropForce(e,"class",o);modPropForce(e,"category_name",d);modPropForce(e,"category_id",g);modPropForce(e,"mode",l);modPropForce(e,"credits",i);modPropForce(e,"short",$(this).find("short").text());modPropForce(e,"add_sel_name",w);modPropForce(e,"inAuswahl","false");modPropForce(e,"cat_id",c);modPropForce(e,"custom",o);modPropForce(e,"custom_exist","false");modPropForce(e,"custom_category",x);modPropForce(e,"additional_info",
m);modPropForce(e,"head_modul_in_pool",D);modPropForce(e,"modul_parts",h);modPropForce(e,"modul_parts_exist","false");modPropForce(e,"id_of_parent_modul",s);modPropForce(e,"add_sel_name_in_sel",w);modPropForce(e,"modul_name_in_pool",k);modPropForce(e,"credits_in_pool",z);modPropForce(e,"credits_in_selection",F);modPropForce(e,"error","unknown");modPropForce(e,"AO_custom_credits","false");modPropForce(e,"AO_disable_warning","false");modPropForce(e,"AO_ignore_grade","false");b+="<div class='"+e+"_parent ' rel='mod_parent'><div class='nichtleer'></div><div class='"+
u+"' id='"+e+"' ><div class='icon_loeschen' style='display:none;' onclick='modul_loeschen("+e+","+e+")'>"+loeschenbild+"</div><span class='modul_id' style='display:none'>"+e+"</span><table cellspacing='0' cellpadding='0' style='width:100%; border:1px;'><tbody><tr><td style=' width:22px;padding:1px 2px 0px 2px; '>"+p+"</td><td class='modul_name' >"+k+C+"</td><td style=' width:22px;display:table-cell' class='fragebild_td'><a style='cursor:pointer' onclick='javascript:info_box("+e+");'><span class='fragebild' style='display:block;margin:0px 0px 0px 0px;' >"+
fragebild+"</span></a></td><td style='width:25px;display:none;margin-right:0px;' class='noten_input_td' ><span class='noten'><input class='noten_input' type='text' size='5' style='margin-right:5px;' rel='"+e+"' value='Note' /></span></td><td style=' width:22px;display:none' class='ipunkt_td'><a style='cursor:pointer' onclick='javascript:info_box_selection("+e+");'><span class='ipunkt' style='padding:1px 2px 0px 0px;'>"+gelber_ipunkt+"</span></a></td><td class='modul_credit' style='width:29px;text-align:right;font-weight:bold'>"+
i+" C</td></tr></tbody></table><p class='drop_down_menu' style='display:none'></p><p class='note-option' style='display:none'>Note gestrichen</p><p class='credit-option' style='display:none'>Ausnahme: Credit-Anzahl wurde ver\ufffd\ufffdndert</p><p class='warnung-option' style='display:none'>Ausnahme: Warnungen deaktiviert</p></div></div>";$("#suche tbody").append("<tr class='"+e+"'   rel='"+u+"' ><td class='cat_check' rel='noCheck' >"+x+"</td><td>"+e+"</td><td class='td_custom_name'>"+k+"</td></tr>");
default:break}});return b},pool=function(){clear_cache();var a=$.ajax({type:"GET",url:"abfragen/pool",async:false,contentType:"application/x-www-form-urlencoded",error:function(){alert("AJAX-Fehler: pool")}}).responseXML.documentElement,b=$("#pool");$("#pool").empty();$("#pool").append(poolrekursiv(a));hide_partial_modul();session_auswahl();custom_modul_in_the_search_table_rekursiv();custom_modul_rekursiv(b);ueberblick()},search_is_active=function(){return $("#qs").val()!=""},change_module_style_to_pool=
function(a,b){$(b).find("> p.credit-option").css("display","none");$(b).find("> p.warnung-option").css("display","none");$(b).find("> p.note-option").css("display","none");modPropForce(a,"AO_custom_credits","false");modPropForce(a,"AO_disable_warning","false");modPropForce(a,"AO_ignore_grade","false");$(b).find("> div.icon_loeschen").css("display","none");var c=modProp(a,"credits");$(b).find("> table tbody tr td.modul_credit").text(c+" C");$(b).find("> p.drop_down_menu").css("display","none").empty();
modProp(a,"additional_info")=="drop_down_schon_in_auswahl"&&modPropChange(a,"additional_info","true");if(modProp(a,"custom")=="custom"){c=modProp(a,"modul_name_in_pool");$(b).find("> table tbody tr td.modul_name").text(c);modPropChange(a,"custom_exist","false");$(b).attr("class","custom_modul");$(b).hide()}modPropChange(a,"error","false");jQuery.each(jQuery.browser,function(){$.browser.msie?$(b).find(".fragebild_td").css("display","inline"):$(b).find(".fragebild_td").css("display","table-cell")});
$(b).find(".ipunkt_td").css("display","none");$(b).find(".ipunkt").html(gelber_ipunkt);$(b).find(".noten_input_td").css("display","none");return 0},change_module_style_to_auswahl=function(a,b){$(b).find("div.icon_loeschen").css("display","block");$(b).find(".fragebild_td").css("display","none");var c=modProp(a,"credits_in_selection");if(modProp(a,"AO_custom_credits")!="false")c=modProp(a,"AO_custom_credits");$(b).find("> table tbody tr td.modul_credit").text(c+" C");jQuery.each(jQuery.browser,function(){if($.browser.msie){$(b).find(".ipunkt_td").css("display",
"inline");modProp(a,"modul_has_grade")!="false"&&$(b).find(".noten_input_td").css("display","inline")}else{$(b).find(".ipunkt_td").css("display","table-cell");modProp(a,"modul_has_grade")!="false"&&$(b).find(".noten_input_td").css("display","table-cell")}flip_module_infoicon_on_event("init",a,b)});return 0},module_div_present_in_parent=function(a){return $(a).text()!=""},modPropForce=function(a,b,c){$.jCache.setItem("m"+a+"::"+b,c)},modPropCreate=function(a,b,c){$.jCache.createItem("m"+a+"::"+b,c)},
modPropChange=function(a,b,c){$.jCache.changeItem("m"+a+"::"+b,c)},modProp=function(a,b){return $.jCache.getItem("m"+a+"::"+b)},display_cache=function(){text=$.jCache.dumpCache();$("#CacheDump").empty().append(text);$("#CacheDump").dialog("open")},clear_cache=function(){$.jCache.clear()};(function(a){this.version="(beta)(0.0.1)";this.maxSize=4E3;this.keys=[];this.cache_length=0;this.items=[];this.setItem=function(b,c){if(typeof c!="undefined"){typeof this.items[b]=="undefined"&&this.cache_length++;this.keys.push(b);this.items[b]=c;if(this.cache_length>this.maxSize){alert("jCache Warning: setItem: Out of cache memory, deleting oldest keys.");this.removeOldestItem()}}return c};this.createItem=function(b,c){if(typeof c!="undefined"){if(typeof this.items[b]=="undefined")this.cache_length++;
else alert("jCache Warning: createItem: Key ("+b+") already exists.");this.keys.push(b);this.items[b]=c;if(this.cache_length>this.maxSize){alert("jCache Warning: createItem: Out of cache memory, deleting oldest keys.");this.removeOldestItem()}}return c};this.changeItem=function(b,c){if(typeof c!="undefined"){if(typeof this.items[b]=="undefined"){this.cache_length++;alert("jCache Warning: changeItem: Key ("+b+") does not exist.")}this.keys.push(b);this.items[b]=c;if(this.cache_length>this.maxSize){alert("jCache Warning: changeItem: Out of cache memory, deleting oldest keys.");
this.removeOldestItem()}}return c};this.removeItem=function(b){var c;if(typeof this.items[b]!="undefined"){this.cache_length--;c=this.items[b];delete this.items[b]}return c};this.getItem=function(b){typeof this.items[b]=="undefined"&&alert("jCache Warning: Accessing undefined key ("+b+").");return this.items[b]};this.hasItem=function(b){return typeof this.items[b]!="undefined"};this.removeOldestItem=function(){this.removeItem(this.keys.shift())};this.clear=function(){var b=this.cache_length;this.keys=
[];this.cache_length=0;this.items=[];return b};this.dumpCache=function(){var b="<p>Memory: "+this.cache_length+" of "+this.maxSize+" slots used.</p>";b+="<table cellspacing='8'><tr><td><strong>#</strong></td><td><strong>key</strong></td><td><strong>value</strong></td></tr>";for(var c=0;c<this.cache_length;c++)b+="<tr><td>"+c+"</td><td>"+this.keys[c]+"</td><td>"+this.items[keys[c]]+"</td></tr>";b+="</table>";return b};a.jCache=this;return a})(jQuery);jQuery(function(a){a.fn.quicksearch=function(b){function c(f){return f===null||f===undefined||f===false?true:false}function d(f){f=f.replace(new RegExp(/\<[^\<]+\>/g),"");return f=a.trim(f.toLowerCase().replace(/\n/,"").replace(/\s{2,}/," "))}function g(){var f=d(a('input[rel="'+j.randomElement+'"]').val());return f.indexOf(" ")===-1?f:f.split(" ")}function e(f,n,r){return r==="string"?k(f,n):l(f,n)}function k(f,n){return n.indexOf(f)>-1}function l(f,n){for(var r=0;r<f.length;r++)if(n.indexOf(f[r])===
-1)return false;return true}function i(f){return j.hideElement==="grandparent"?a(f).parent().parent():j.hideElement==="parent"?a(f).parent():a(f)}function h(f){if(J){var n=0;i(f).filter(":visible").each(function(){for(var r=0;r<G;r++)n===r?a(this).addClass(j.stripeRowClass[n]):a(this).removeClass(j.stripeRowClass[r]);n=(n+1)%G})}}function o(f){a(f).find("td").each(function(){a(this).attr("width",parseInt(a(this).css("width")))})}function m(f){if(j.loaderId){var n=a('input[rel="'+j.randomElement+'"]').parent().find(".loader");
f==="hide"?n.hide():n.show()}}function q(){var f=j.position,n=j.attached;if(f==="before")a(n).before(s());else if(f==="prepend")a(n).prepend(s());else f==="append"?a(n).append(s()):a(n).after(s())}function p(){if(!c(j.labelText))return'<label for="'+j.randomElement+'" class="'+j.labelClass+'">'+j.labelText+"</label> ";return""}function w(){return'<input type="text" value="'+(!c(j.inputText)?j.inputText:"")+'" style="margin:2px;" rel="'+j.randomElement+'" class="'+j.inputClass+'" id="'+j.randomElement+
'" /> '}function u(){return c(j.loaderImg)?'<div id="'+j.loaderId+'" class="'+j.loaderClass+'">'+warten_weiss+"</div>":'<img src="'+j.loaderImg+'" alt="Loading" id="'+j.loaderId+'" class="'+j.loaderClass+'" />'}function s(){var f=!j.isFieldset?"form":"fieldset";return"<"+f+' action="#" id="'+j.formId+'" class="quicksearch">'+p()+w()+u()+"</"+f+">"}function C(){a('input[rel="'+j.randomElement+'"]').get(0).focus()}function D(){a('input[rel="'+j.randomElement+'"]').focus(function(){a(this).val()===j.inputText&&
a(this).val("")});a('input[rel="'+j.randomElement+'"]').blur(function(){a(this).val()===""&&a(this).val(j.inputText)})}function x(f){return a(f).map(function(){return d(this.innerHTML)})}function z(){a("#pool").show();var f=a("#pool").children();a(f).show();a(f).each(function(){if(a(this).hasClass("search_category")){a(this).removeClass("search_category");a(this).addClass("pool_category")}a(this).find("span.pfeil_rechts").each(function(){a(this).css("display","inline")});a(this).find("span.pfeil_unten").each(function(){a(this).css("display",
"none")});a(this).find(".pool_category,.pool_modul,.partial_modul,.custom_modul").hide();a(this).find(".search_modul").each(function(){a(this).removeClass("search_modul")});a(this).find(".search_category").each(function(){a(this).removeClass("search_category");a(this).addClass("pool_category");a(this).hide()})})}function A(f){var n=a(f).parent().get(0);a(f).attr("id");a(f).show();if(a(f).hasClass("pool_category")){flip_arrow_of_category("unten",f);a(f).attr("class","search_category");A(a(n))}}function F(f){z();
for(var n=0;n<f.length;n++)a("#pool ."+f[n]+"_parent").each(function(){a(this).addClass("search_modul");var r=a("#pool").find("#"+f[n]),y=modProp(f[n],"inAuswahl"),v=modProp(f[n],"id_of_parent_modul");if(y=="false"&&v=="false"){a(this).show();a(r).show();r=a(this).parent().get(0);A(a(r))}});a(".pool_category").hide()}function K(){q();j.fixWidths&&o(t);j.focusOnLoad&&C();j.inputText!=""&&j.inputText!=null&&D();E=x(t);h(t);m("hide");H=a("table#suche tbody tr").length}function L(){clearTimeout(I);I=
setTimeout(function(){m("show");setTimeout(function(){j.onBefore();var f=g(),n=typeof f;f=j.filter(f);if(f!=""){if(typeof B[f]==="undefined"){B[f]=[];E.each(function(v){if(e(f,E[v],n))B[f][v]=true})}B[f].length===0?i(t).hide():a(t).each(function(v){B[f][v]?i(this).show():i(this).hide()})}else i(t).show();var r=[],y=a("table#suche tbody tr");y=a(y).filter(function(){return a(this).css("display")=="table-row"||a(this).css("display")=="block"});if(a(y).length!=H){a(y).each(function(){if(a(this).attr("rel")==
"pool_modul"||a(this).attr("rel")=="pool_modul ui_draggable"){var v=a(this).attr("class");r.push(v)}});F(r)}else z();h(t)},j.delay/2);setTimeout(function(){m("hide")},j.delay/2);j.onAfter()},j.delay/2)}var j=a.extend({position:"prepend",attached:"body",formId:"quicksearch",labelText:"Quick Search",labelClass:"qs_label",inputText:null,inputClass:"qs_input",loaderId:"loader",loaderClass:"loader",loaderImg:null,loaderText:"Loading...",stripeRowClass:null,hideElement:null,delay:500,focusOnLoad:false,
onBefore:function(){},onAfter:function(){},filter:function(f){return f},randomElement:"qs",isFieldset:false,fixWidths:false},b),I,B={},G=!c(j.stripeRowClass)?j.stripeRowClass.length:0,J=G>0?true:false,t=this,E,M=a(this).selector,H;a.fn.extend({reset_cache:function(){t=a(M);E=x(t)}});K();a('input[rel="'+j.randomElement+'"]').keydown(function(f){f=f.keyCode;f===9||f===13||f===16||f===17||f===18||f===38||f===40||f===224||L()});a("form.quicksearch, fieldset.quicksearch").submit(function(){return false});
return this}});function updateTips(a,b){b.text(a).effect("highlight",{},1500)}
var custom_check=function(a,b,c,d,g,e,k){var l=false,i=new Array(1);i[0]=-1;$("#dummy_checkbox input[type='checkbox']").each(function(){if($(this).is(":checked")){l=true;i.push($(this).attr("value"))}});d=d.attr("value");g=g.attr("value");c=c.attr("value");l||i.push(c.split("_")[1]);c="true";if($("#hat_note input[type='checkbox']").is(":checked"))c="false";modPropChange(g,"modul_has_grade",c);var h=b.val(),o=a.val(),m=parseFloat(h);if(a.val().length<k){a.addClass("ui-state-error");updateTips("Bitte geben Sie ein Namen ein.",
e);return false}else o="Sonstiges Modul: "+o;if(h.length<k||isNaN(m)){b.addClass("ui-state-error");updateTips("Bitte geben Sie als Credits eine eine ganze Zahl ein.",e);return false}else{a=h.search(/,/);b=h;if(a!=-1)b=h.replace(/\,/,".");e=parseFloat(b);var q=$("#pool #"+g);a=$("#name");b=$("#credit");a=b.attr("value");$(q).attr("class","auswahl_modul ui-draggable");$(q).find(".modul_name").text(o);$(q).find(".modul_credit").text(a+" C");modPropChange(g,"credits_in_selection",a);modPropChange(g,"inAuswahl",
"true");$("#middle").find(".semester").each(function(){if($(this).attr("id")==d){var p=$(this).find(".subsemester");$(p).append(q)}});change_module_style_to_auswahl(g,q);ajax_serverupdate_add_custom(o,e,i,d,g,c);ajax_serverupdate_grade_reset(g);return true}};
$(function(){var a=$("#name"),b=$("#credit"),c=$("#custom_cat_id"),d=$("#custom_semester"),g=$("#custom_id"),e=$("#validateTips"),k=$([]).add(a).add(b);$("#custom_dialog").dialog({modal:true,height:300,width:500,autoOpen:false,open:function(){a.attr("value","");b.attr("value","");ajax_request_custom_checkbox($(g).attr("value"))},buttons:{Fertig:function(){k.removeClass("ui-state-error");if(custom_check(a,b,c,d,g,e,1,4)){var i="Sonstiges Modul: "+a.attr("value");b.attr("value");c.attr("value");d.attr("value");
var h=g.attr("value");$("#semester-content #"+h);var o=modProp(h,"custom_exist"),m=modProp(h,"custom_category");if(o=="false"){show_next_custom_modul_in_pool(m);get_and_change_custom_modul_in_the_table(h,i,m)}$(this).dialog("close")}}}});$("#info_box").dialog({modal:true,height:400,width:550,position:"center",autoOpen:false,open:function(){},buttons:{OK:function(){$("#box_info_exception").css("display")=="block"&&update_modul_in_selection();$("#info_box").dialog("close")}}});$("#CacheDump").dialog({modal:true,
height:400,width:550,position:"center",autoOpen:false,open:function(){$("#CacheDump").show()},buttons:{OK:function(){$("#CacheDump").dialog("close")}}});$(".auswahl_modul,.auswahl_modul_clone,.auswahl_modul.ui-draggable,.partial_modul,.auswahl_modul.partial_modul.ui-draggable").draggable({revert:"invalid",helper:"clone",cursorAt:{right:125,top:13}});$(".pool_modul,.custom_modul").draggable({revert:"invalid",helper:"clone",cursorAt:{left:120,top:13}});$("#pool .pool_modul").hide();$("#vorratbox").droppable({hoverClass:"drophover",
drop:function(i,h){$(this).append(h.draggable)}});$("#pool").droppable({accept:".auswahl_modul,.auswahl_modul_clone",hoverClass:"drophover",drop:function(i,h){$(h.draggable);i=$(h.draggable).attr("id");$(this);$(h.helper).remove();modul_loeschen(i)}});$(".semester").droppable({hoverClass:"drophover",accept:".pool_modul ,.auswahl_modul,.auswahl_modul_clone,.custom_modul",drop:function(i,h){i=$(h.draggable);var o=$(h.helper),m=$(this),q=$(this).attr("id"),p=$(h.draggable).attr("id");h=$(h.draggable).attr("class");
var w=modProp(p,"custom"),u=modProp(p,"modul_parts"),s=modProp(p,"modul_parts_exist");if(w=="non-custom")if(u!="0"&&s=="false"){change_credit_and_add_name_in_selection(p,i);drop_in_auswahl(p,h,q,i,m,o);partial_modul_drop_in_auswahl(p,h,q,i,m,o)}else drop_in_auswahl(p,h,q,i,m,o);else h=="auswahl_modul ui-draggable"||h=="auswahl_modul"||h=="auswahl_modul_clone ui-draggable"?drop_in_auswahl(p,h,q,i,m,o):custom_modul_drop_in_auswahl(p,h,q,i,m,o)}});var l=true;$("input.noten_input").focus(function(){l=
true;$(this).val()=="Note"&&$(this).attr("value"," ");$(this).select();$("#note_berechnen").text("Note wird bearbeitet")});$("input.noten_input").bind("keypress",function(i){if(i.keyCode==13){$(this).trigger("change");$("#enter_trick").trigger("focus");l=false}});$("input.noten_input").change(function(i){if(l){i.preventDefault();selection_input_check(this)}})});
var sem_hinzu=function(){$(function(){var a=$("#semester-content div.semester").length+1,b="<div class='semester' id='"+a+"'><div class='subsemester'><h5>"+a+" .Semester</h5></div><a class='semesterloeschen' onClick='sem_loeschen("+a+");'>Semester entfernen</a></div>";$("#semester-content").append(b);$(".semester[id="+(a-1)+"] .semesterloeschen").css("display","none");$(".semester[id="+a+"] .semesterloeschen").css("display","inline");$(".semester").droppable({hoverClass:"drophover",drop:function(c,
d){c=$(d.draggable);var g=$(d.helper),e=$(this),k=$(this).attr("id"),l=$(d.draggable).attr("id"),i=$(d.draggable).attr("class"),h=$(d.draggable).find("span.custom").text(),o=$(d.draggable).find("span.modul_parts").text();d=$(d.draggable).find("span.modul_parts_exist").html();if(h=="non-custom"){o!="0"&&d=="false"&&partial_modul_drop_in_auswahl(l,i,k,c,e,g);drop_in_auswahl(l,i,k,c,e,g)}else i=="auswahl_modul ui-draggable"||i=="auswahl_modul"||i=="auswahl_modul_clone ui-draggable"?drop_in_auswahl(l,
i,k,c,e,g):custom_modul_drop_in_auswahl(l,i,k,c,e,g)}})})},sem_loeschen=function(a){lint=parseInt(a);if(parseInt(a)!="1"){a=$(".semester[id="+lint+"]");var b=$(a).find(".auswahl_modul,.auswahl_modul_clone"),c=false;c=b.length==0?true:confirm("Wollen Sie das Semester komplett entfernen?");if(c==true){$(a).hide();b.each(function(){$(this).css("display","none");modul_loeschen($(this).attr("id"),"10000")});$(a).remove();if(lint>1){$(".semester[id="+(lint-1)+"] .semesterloeschen").css("display","inline");
b.length>0&&ajax_to_server_by_remove_semester(lint)}}}},toggle_category=function(a){a=$("#pool").find("#"+a);switch(which_arrow_is_visible(a)){case "rechts":var b=0;$(a).children().not("a, .nichtleer").each(function(){var c=$(this).attr("class");if(c=="pool_category"||c=="search_category")if(search_is_active()){if(c=="search_category")if($(this).attr("class")!="partial_modul"){$(this).css("display","block");b++}else $(this).hide()}else{$(this).css("display","block");b++;number_of_visible_items_in_category(this)==
0&&flip_arrow_of_category("leer",this)}else $(this).children().each(function(){if(modProp($(this).parent().attr("class").split("_")[0],"inAuswahl")=="false")if(search_is_active()){if($(this).parent().is(".search_modul"))if($(this).attr("class")!="partial_modul"){$(this).css("display","block");b++}}else{if($(this).is(".pool_modul")){$(this).css("display","block");b++}}else $(this).css("display","none")})});b==0?flip_arrow_of_category("leer",a):flip_arrow_of_category("unten",a);break;case "unten":flip_arrow_of_category("rechts",
a);$(a).children().not("a, .nichtleer").each(function(){var c=$(this).attr("class");c=="pool_category"||c=="search_category"?$(this).css("display","none"):$(this).find(">*").css("display","none")});break;case "leer":break;default:alert("Fehler: Ungueltiger Pfeil-Wert in toggle_category().")}},number_of_visible_items_in_category=function(a){var b=$(a).attr("class");b=="pool_category"||b=="search_category"||alert("Fehler: Handle in number_of_visible_items_in_category() ist keine Kategorie!");var c=
0;$(a).children().not("a, .nichtleer").each(function(){b=$(this).attr("class");if(b=="pool_category"||b=="search_category")if(search_is_active())b=="search_category"&&c++;else c++;else $(this).children().not(".auswahl_modul_moving").each(function(){if(modProp($(this).parent().attr("class").split("_")[0],"inAuswahl")=="false"&&$(this).is(".pool_modul"))if(search_is_active())$(this).parent().is(".search_modul")&&c++;else c++})});return c},flip_arrow_of_category=function(a,b){$(b).attr("class");switch(a){case "rechts":$(b).find(">a .pfeil_unten").css("display",
"none");$(b).find(">a .pfeil_rechts").css("display","inline");$(b).find(">a .pfeil_leer").css("display","none");break;case "unten":$(b).find(">a .pfeil_unten").css("display","inline");$(b).find(">a .pfeil_rechts").css("display","none");$(b).find(">a .pfeil_leer").css("display","none");break;case "leer":$(b).find(">a .pfeil_unten").css("display","none");$(b).find(">a .pfeil_rechts").css("display","none");$(b).find(">a .pfeil_leer").css("display","inline");break;default:alert("Fehler in flip_arrow_of_category: Typ "+
a+" unbekannt!")}},which_arrow_is_visible=function(a){var b=$(a).attr("class");b=="pool_category"||b=="search_category"||alert("Fehler: Handle in which_arrow_is_visible() ist keine Kategorie!");b="unbekannt";if($(a).find(">a .pfeil_unten").css("display")=="inline")b="unten";else if($(a).find(">a .pfeil_rechts").css("display")=="inline")b="rechts";else if($(a).find(">a .pfeil_leer").css("display")=="inline")b="leer";return b};var info_box_overview=function(a){$("#box_info").empty();$("#box_info_exception").hide();$("#box_info_pool").show();$("#box_info_combobox").hide();$("#info_box").dialog("open");$.ajax({type:"POST",url:"/abfragen/info/"+a,data:authenticityTokenParameter(),async:false,contentType:"application/x-www-form-urlencoded",success:function(b){$("#box_info").empty();$("#box_info").append(b);$("#box_info_overview").hide()},error:function(){alert("problem with /abfragen/info")}})},ueberblick=function(){$("#ueberblick #ueberblick-wird-aktualisiert").show();
$.ajax({type:"GET",url:"/abfragen/ueberblick",async:false,contentType:"application/x-www-form-urlencoded",success:function(a){$("#ueberblick #ueberblick_baum").empty();$("#ueberblick #ueberblick_baum").html(a);ajax_request_grade()},error:function(){alert("problem with /abfragen/ueberblick")}});update_module_errors();update_category_errors();$(".ueberblick_info_box").mouseenter(function(){$(this).animate({opacity:0.4},"fast");$(this).animate({opacity:1},"slow")})},update_category_errors=function(){$("#ueberblick").find(".ueberblick_info_box").each(function(){var a=
$(this).attr("id").split("#")[1],b="false";if($(this).find("a > img").attr("alt")!="Ipunkt")b="true";if($.jCache.hasItem("c"+a+"::error")){if($.jCache.getItem("c"+a+"::error")!=b){$.jCache.changeItem("c"+a+"::error",b);$(this).animate({opacity:0.1},"fast");$(this).animate({opacity:1},"fast");$(this).animate({opacity:0.1},"fast");$(this).animate({opacity:1},"fast");$(this).animate({opacity:0.1},"fast");$(this).animate({opacity:1},"fast")}}else $.jCache.createItem("c"+a+"::error",b)})};